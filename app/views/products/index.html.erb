<div class="wrapper-dashboard">
  <div class="container-fluid">
    <div class="row">
        <% @products.each do |product| %>
      <div class="col-xs-6 col-sm-3">
        <div id='card'>
          <%= image_tag product.photo, id: 'userImage' %>
          <i class="fa fa-amazon" id='badge-card'></i>
          <h4 id='playerName'><%= product.name %></h4>
            <div id='states'>
              <ul id='info'>
                <li>
                  Prix
                </li>
                <li>
                  Status
                </li>
              </ul>
              <ul id='values'>
                <li><%= product.price %></li>
                <% if product.delivery_steps == nil %>
                  <li>Aucun suivis</li>
                <% else %>
                  <li><%= product.delivery_steps %></li>
                <% end %>
              </ul>
            </div>
            <% if product.tracking_number.empty? %>
              <a href='#' id='contactBtn' type="button", data-toggle="modal" data-target="#product-modal-<%= product.id %>">
                <i class='fa fa-paper-plane spin'></i>
                 Suivre
              </a>
          <% else %>
          <div class="small-margin-card">
            <div class="progress">
              <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="70"
              aria-valuemin="0" aria-valuemax="100" style="width:70%">
                70%
              </div>
            </div>
          </div>
          <% end %>
          <div class="modal fade" id="product-modal-<%= product.id %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
              <div class="modal-style">
                <div class="modal-content">
                  <div class="modal-header text-center">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Suivre votre colis</h4>
                  </div>
                  <div class="modal-body">
                  <%= simple_form_for(product) do |f| %>
                    <div class="form-inline">
                      <div class="form-inputs text-center">
                        <%= f.input :tracking_number, placeholder: 'NumÃ©ro de colis',label: false%>
                        <%= f.button :submit, 'Ajouter', class: 'track_button' %>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
        <% end %>
    </div>
  </div>
</div>

<div class="fb-send-to-messenger"
  messenger_app_id="<%= ENV['FACEBOOK_APP_ID'] %>"
  page_id="<%= ENV['FB_PAGE_ID'] %>"
  data-ref="<%= current_user.id %>"
  color="blue"
  size="standard" ></div>

<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : <%= ENV["FACEBOOK_APP_ID"] %>,
      xfbml      : true,
      version    : 'v2.7'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
